<!DOCTYPE html>
<html lang="en">
<% include components/htmlhead %>

<body>
    <% include components/navbar %>
    <div class="container">
        <div class="row">
            <div class="col-md-3"></div>
            <div class="col-sm-12 col-md-6">
                <h1>Update a task</h1>
                <% if (typeof errorMsg !== 'undefined') { %>
                    <p id="errorMsg" class="text-danger"><%= errorMsg %></p>
                <% } %>

                <% if (tasks.length > 0) { %>
                <table class="table table-striped">
                    <thead>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Assigned By</th>
                        <th>Status</th>
                        <th>Update</th>
                    </thead>
                    <tbody>
                <% for (var i = 0; i< tasks.length; i++) { %>
                  <form name=<%= 'update' + tasks[i][0] %> action=<%= 'tasks/' + tasks[i][0] %> method="post">
                      <tr>
                          <input type="hidden" name="id" value=<%= tasks[i][0] %> />
                          <td><%= tasks[i][1] %></td>
                          <td><%= tasks[i][2] %></td>
                          <td><%= tasks[i][3] %></td>
                          <td>
                              <select name="status">
                                  <% for (var j=0;j<statuses[i].length;j++) { %>
                                  <% if(statuses[i][j]==tasks[i][4]) { %>
                                  <option selected><%= statuses[i][j] %></option>
                                  <% } else { %>
                                  <option><%= statuses[i][j] %></option>
                                  <% } %> <!-- if statuses/task -->
                                  <% } %> <!-- for j loop -->
                              </select>
                          </td>
                          <td><button type="submit" class="btn btn-default">Update</button></td>
                      </tr>
                    </form>
                <% } %> <!-- for loop ends -->
                          </tbody>    
                </table>
                <% } else { %> <!-- if block ends -->
                  <p>No tasks have been assigned to you yet.</a></p>
                <% }  %>
            </div>
            <div class="col-md-3"></div>
        </div>
    </div> <!-- container -->
    <% include components/scripts %>
</body>
</html>
